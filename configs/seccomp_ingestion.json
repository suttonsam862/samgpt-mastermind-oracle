
{
  "defaultAction": "SCMP_ACT_ERRNO",
  "architectures": ["SCMP_ARCH_X86_64"],
  "syscalls": [
    {
      "names": [
        "access", "arch_prctl", "brk", "capget", "capset", "chdir", "clock_getres",
        "clock_gettime", "clone", "close", "connect", "dup", "dup2", "epoll_create",
        "epoll_create1", "epoll_ctl", "epoll_pwait", "epoll_wait", "eventfd2", "execve",
        "exit", "exit_group", "fcntl", "fdatasync", "flock", "fstat", "fstatfs",
        "fsync", "futex", "getcwd", "getdents", "getdents64", "geteuid", "getgid",
        "getpeername", "getpid", "getppid", "getrandom", "getresgid", "getresuid",
        "getrlimit", "getrusage", "getsockname", "getsockopt", "gettid", "gettimeofday",
        "getuid", "inotify_add_watch", "inotify_init", "inotify_init1", "inotify_rm_watch",
        "ioctl", "kill", "listen", "lseek", "madvise", "mkdir", "mmap", "mprotect",
        "munmap", "nanosleep", "newfstatat", "open", "openat", "pipe", "pipe2", "poll",
        "prctl", "pread64", "prlimit64", "read", "readlink", "recvfrom", "recvmsg",
        "rename", "rmdir", "rt_sigaction", "rt_sigprocmask", "rt_sigreturn", "sched_getaffinity",
        "sched_yield", "select", "sendmmsg", "sendmsg", "sendto", "set_robust_list",
        "set_tid_address", "setgid", "setgroups", "setrlimit", "setsockopt", "setuid",
        "sigaltstack", "socket", "socketpair", "stat", "statfs", "sysinfo", "tgkill",
        "timerfd_create", "timerfd_settime", "umask", "uname", "unlink", "wait4", "write",
        "writev"
      ],
      "action": "SCMP_ACT_ALLOW"
    },
    {
      "names": ["socket"],
      "action": "SCMP_ACT_ALLOW",
      "args": [
        {"index": 0, "value": 2, "op": "SCMP_CMP_EQ"},  // AF_INET
        {"index": 1, "value": 1, "op": "SCMP_CMP_EQ"}   // SOCK_STREAM
      ]
    },
    {
      "names": ["connect"],
      "action": "SCMP_ACT_ALLOW",
      "args": [
        {"index": 2, "value": 16, "op": "SCMP_CMP_EQ"}  // Length of sockaddr
      ]
    }
  ]
}
